@import play.filters.csrf.CSRF.Token
@(viewerUrl: String, actualUrl: String, previewEnv: String, composerUrl: String, proxyBase: String, path: String, csrfToken: Option[Token])

@main("Viewer") {
    <header>
        <div class="top-toolbar">
            <div class="top-toolbar__logo">
                <a class="top-toolbar__logo-link" href="@composerUrl" title="Return to composer"></a>
            </div>

            <div class="top-toolbar__view-toolbar">
                <ul class="tool-bar">
                    <li class="top-toolbar__item">
                        @if(previewEnv == "preview") {
                            <div class="top-toolbar__status--@previewEnv">DRAFT</div>
                        } else {
                            <div class="top-toolbar__status--@previewEnv">@previewEnv</div>
                        }
                    </li>
                    <li class="top-toolbar__item">
                        <div class="top-toolbar__label">Web</div>
                        <div class="viewer-orientation">
                            <button class="viewer-orientation__button is-selected" data-switch-mode="mobile-portrait" aria-label="Mobile web portrait">
                                <i class="top-toolbar__icon--mobile-portrait"></i>
                            </button>
                            <button class="viewer-orientation__button" data-switch-mode="mobile-landscape" aria-label="Mobile web landscape">
                                <i class="top-toolbar__icon--mobile-landscape"></i>
                            </button>
                            <button class="viewer-orientation__button" data-switch-mode="desktop" aria-label="Desktop web">
                                <i class="top-toolbar__icon--desktop"></i>
                            </button>
                        </div>
                    </li>
                    <li class="top-toolbar__item">
                        <button class="top-toolbar__button" data-app-preview>
                            <i class="top-toolbar__button--appApple"></i>
                            <i class="top-toolbar__button--appAndroid"></i>
                            Get app preview link
                        </button>
                    </li>
                    @if(previewEnv == "preview") {
                        <li class="top-toolbar__item">
                            <button class="top-toolbar__button" data-redirect-preview>
                                Having trouble? Try this
                            </button>
                        </li>
                        <li class="top-toolbar__item">
                            <button class="top-toolbar__button" data-switch-mode="social-share">
                                <i class="top-toolbar__icon--socialshare"></i>Social share
                            </button>
                        </li>
                        <li class="top-toolbar__item">
                            <button class="top-toolbar__button" data-switch-mode="reader">
                                <i class="top-toolbar__icon--copycheck"></i>Copy taste
                            </button>
                        </li>
                        <li class="top-toolbar__item">
                            <button class="top-toolbar__button--blockads" data-toggle-ads>
                                <i class="top-toolbar__icon--checkbox"></i>Block ads
                            </button>
                        </li>
                    } else {
                        <li class="top-toolbar__item">
                            <button class="top-toolbar__button" data-switch-mode="social-share">
                                <i class="top-toolbar__icon--socialshare"></i>Social share
                            </button>
                        </li>
                        <li class="top-toolbar__item">
                            <a href="@actualUrl" class="top-toolbar__button"><i class="top-toolbar__icon--guardian"></i>View on theguardian.com</a>
                        </li>
                    }
                    <li class="top-toolbar__item--right">
                        <button class="top-toolbar__button" data-print>
                            <i class="top-toolbar__icon--printer"></i>Print version
                        </button>
                    </li>
                </ul>
            </div>
        </div>
        <div class="info-bar reader-mode-info">Copy taste presents you with a distraction free view of the article content. If you have any feedback please email the <a href="mailto:digitalcms.dev@@guardian.co.uk">Digital CMS</a> team</div>
        <div id="errorbar" class="error-bar"></div>
        <div id="messageBar" class="message-bar"></div>
    </header>

    <div class="content">
        <div class="viewers">
            <iframe class="viewer is-mobile-portrait" src="@viewerUrl#noads" title="Mobile viewer"></iframe>
            <div class="viewer is-desktop">
                <iframe src="@viewerUrl#noads" title="Desktop viewer"></iframe>
                <div class="is-desktop__overlay">
                    <p>To enable desktop preview you need to check and verify mobile first</p>
                    <button data-enable-desktop>I have checked the mobile preview</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        window._baseAppUrl = '/@previewEnv';
        window._previewEnv = "@previewEnv";
        window._actualUrl = "@actualUrl";
        window._proxyBase = "@proxyBase";
        window._originalPath = "@path";
        @csrfToken.map { token =>
            window._csrfToken = {
                name: "@token.name",
                value: "@token.value"
            };
        }
    </script>
}
